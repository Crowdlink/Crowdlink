(function($){$.fn.yota_activate=function(options){var form_obj=this;var settings=$.extend({render_success:function(data,ids){if(data.custom_success!=undefined){}else{if(ids.error_id!=undefined){$("#"+ids.error_id).show();$("#"+ids.error_id).html(data.message)}}},render_error:function(id,status,data){if(id.elements[0]==undefined){console.log("There are no elements defined to deliver this error to!");return}target_id=id.error_id;if(status=="no_error"){$("#"+target_id).fadeOut()}if(status=="update"||status=="error"){if(data.length>1){var tip="<ul>";for(var key in data){tip+="<li>"+data[key]["message"]+"</li>"}tip+="</ul>"}else{var tip=data[0]["message"]}$("#"+target_id).html(tip);$("#"+target_id).removeClass();$("#"+target_id).addClass(data[0]._type_class);$("#"+target_id).fadeIn()}},piecewise:false,process_builtins:true},options);var errors_present={};$(this).data("yota_errors_present",errors_present);var ajax_options={success:function(jsonObj){if(jsonObj.success==false){error_obj=jsonObj.errors;for(var key in error_obj){if(key in errors_present){settings.render_error(error_obj[key].identifiers,"update",error_obj[key].errors)}else{settings.render_error(error_obj[key].identifiers,"error",error_obj[key].errors);errors_present[key]=error_obj[key].identifiers}}for(var key in errors_present){if(!(key in error_obj)){settings.render_error(errors_present[key],"no_error",{});delete errors_present[key]}}}else{for(var key in errors_present){settings.render_error(errors_present[key],"no_error",{});delete errors_present[key]}if(jsonObj.redirect!=undefined){window.location.replace(jsonObj.redirect);return}if("success_blob" in jsonObj){opts=jsonObj.success_blob;if(settings.process_builtins==true){if(opts.custom_success){eval(opts.custom_success)}if(opts.reset_form==true){$(form_obj)[0].reset()}if(opts.redirect){window.location.replace(opts.redirect)}if(opts.ga_run){if(typeof(ga)==="function"){ga("send","event",opts.ga_run[0],opts.ga_run[1],opts.ga_run[2],opts.ga_run[3])}}}}else{opts=""}settings.render_success(opts,jsonObj.success_ids)}},beforeSubmit:function(arr,form,options){var visited=$(form).data("yota_visited");var json=JSON.stringify(visited);arr.push({name:"_visited_names",value:json})},dataType:"json"};$(this).data("yota_ajax_options",ajax_options);if(settings.piecewise){var visited={};$(this).data("yota_visited",visited);$(this).find(":input").each(function(){var trigger=$(this).data("piecewise");var name=$(this).attr("name");if(trigger){$(this).on(trigger,function(){visited[name]=true;$(form_obj).ajaxSubmit(ajax_options)})}})}$(this).submit(function(){if(settings.piecewise){$(this).find(":input").each(function(){var name=$(this).attr("name");visited[name]=true})}$(this).ajaxSubmit($.extend({data:{submit_action:"true"}},ajax_options));return false});return this}}(jQuery));