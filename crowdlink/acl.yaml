# Base class
base_private:
    virtual: true
    # global context roles
    anonymous: []
    user:
        class:
            - create
    # Object context roles
    owner:
        view:
            - standard_join

solution:
    # global context roles
    anonymous:
        view:
            - standard_join
            - page_join
            - disp_join
    noactive_user:
        inherit: anonymous
        edit:
            - subscribed
    usernameless:
        inherit: noactive_user
    user:
        inherit: noactive_user
        edit:
            - report_status
            - vote_status
        class:
            - create
    admin:
        inherit: maintainer
        class:
            - create_other

    # Object context roles
    maintainer:
        inherit: user
        edit:
            - url_key
            - title
            - desc
    creator:
        inherit: maintainer

user:
    # global context roles
    anonymous:
        view:
            - standard_join
            - page_join
            - disp_join
        class: create
    noactive_user:
        view:
            - standard_join
            - page_join
            - disp_join
        edit:
            - subscribed
    usernameless:
        inherit: noactive_user
    user:
        inherit: noactive_user
        edit:
            - vote_status
            - report_status
    admin:
        inherit: owner
        class: create_other
    # Object context roles
    owner:
        inherit: user
        edit: url_key
        view: home_join
project:
    # global context roles
    anonymous:
        view:
            - page_join
            - issue_page_join
            - disp_join
    noactive_user:
        inherit: anonymous
        edit: subscribed
    usernameless:
        inherit: noactive_user
    user:
        inherit: noactive_user
        action: add_issue
        edit:
            - report_status
            - vote_status
        class: create
    admin:
        inherit: maintainer
        class: create_other
    # Object context roles
    maintainer:
        inherit: user
        edit:
            - name
            - website
issue:
    # global context roles
    anonymous:
        view:
            - standard_join
            - page_join
            - brief_join
            - disp_join
    noactive_user:
        inherit: anonymous
        edit:
            - subscribed
    usernameless:
        inherit: noactive_user
    user:
        inherit: noactive_user
        action:
            - add_solution
        edit:
            - report_status
            - vote_status
            - subscribed
        class:
            - create
    admin:
        inherit:
            - anonymous
            - user
            - maintainer
        class:
            - create_other
    # Object context roles
    maintainer:
        inherit: user
        edit:
            - url_key
            - _status
            - title
            - desc
    creator:
        inherit: maintainer

charge:
    inherit: base_private
    # global context roles
    admin:
        view:
            - standard_join
    # Object context roles
    owner:
        action:
            - add_earmark

mark:
    # global context roles
    user:
        class: create
    sender:
        view: standard_join
    admin:
        inherit: sender
    reciever:
        inherit: sender

earmark:
    # global context roles
    user:
        class:
            - create
    admin:
        inherit: reciever
    sender:
        view:
            - standard_join
        action:
            - increase_amount
    reciever:
        view:
            - standard_join

transfer:
    inherit: base_private
    # global context roles
    user:
        class:
            - create
    admin:
        inherit: owner
        class:
            - create_other

recipient:
    inherit: base_private
    admin:
        inherit: owner
