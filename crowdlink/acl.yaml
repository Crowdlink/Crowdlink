# Base class
base_private:
    virtual: true
    # global context roles
    anonymous: []
    user:
        class: create
    # Object context roles
    owner:
        view: standard_join

solution:
    # global context roles
    anonymous:
        view:
            - standard_join
            - page_join
            - disp_join
    noactive_user:
        inherit: anonymous
        edit: subscribed
    usernameless:
        inherit: noactive_user
    user:
        inherit: noactive_user
        edit:
            - report_status
            - vote_status
        class: create
    admin:
        inherit: issue_project_maintainer
        class: create_other

    # Object context roles
    issue_project_maintainer:
        inherit: user
        edit:
            - url_key
            - title
            - desc
    issue_creator:
    creator:
        inherit: issue_project_maintainer
email:
    # global context roles
    anonymous:
        action:
            - check_taken

user:
    # global context roles
    anonymous:
        view:
            - standard_join
            - page_join
            - disp_join
        class: create
        action:
            - oauth_create
            - login
            - send_recover
            - recover
            - check_taken
    noactive_user:
        view:
            - standard_join
            - page_join
            - disp_join
        edit: subscribed
        action:
            - check_taken
    user:
        inherit: noactive_user
        edit:
            - report_status
    admin:
        inherit: owner
        class: create_other
    # Object context roles
    owner:
        inherit: user
        edit:
            - go_linked
            - gh_linked
            - tw_linked
        action:
            - refresh_provider
        view:
            - home_join
            - settings_join
project:
    # global context roles
    anonymous:
        view:
            - page_join
            - issue_page_join
            - disp_join
        action:
            - check_taken
    noactive_user:
        inherit: anonymous
        edit: subscribed
    usernameless:
        inherit: noactive_user
    user:
        inherit: noactive_user
        edit:
            - report_status
            - vote_status
        class: create
    admin:
        inherit: maintainer
        class: create_other
    # Object context roles
    maintainer:
        inherit: user
        action:
            - add_admin
        edit:
            - name
            - website
issue:
    # global context roles
    anonymous:
        view:
            - standard_join
            - page_join
            - brief_join
            - disp_join
    noactive_user:
        inherit: anonymous
        edit: subscribed
    usernameless:
        inherit: noactive_user
    user:
        inherit: noactive_user
        edit:
            - report_status
            - vote_status
            - subscribed
        class: create
    admin:
        inherit: project_maintainer
        class: create_other
    # Object context roles
    project_maintainer:
        inherit: user
        edit:
            - url_key
            - _status
            - title
            - desc
    creator:
        inherit: project_maintainer

comment:
    # global context roles
    anonymous:
        view: standard_join
    noactive_user:
        inherit: anonymous
    usernameless:
        inherit: noactive_user
    user:
        inherit: noactive_user
        class: create
        edit: report_status
    admin:
        inherit: thing_project_maintainer
        class: create_other
        edit: banned
    # Object context roles
    thing_project_maintainer:
        inherit: user
        edit: hidden
    creator:
        inherit: thing_project_maintainer
