{% extends "base.html" %}

{% block title %}Home{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-8 no-gutter">
    <h2>
      {{ project.name }}
    </h2>
    <h4>
      <b>Created </b>{{ project.created_at|date }}
      ({{ project.created_at|date_ago }})
    </h4>
    <h4>
      <b>Maintainer </b>
      <a href="{{ project.maintainer.get_abs_url() }}">{{ project.maintainer.username }}</a>
    </h4>
  </div>
  <div class="col-md-4 no-gutter">
    <br />
    <div class="btn-group-vertical pull-right" style="width:70%;">
      <a class="btn btn-default"
            data-type="watch"
            data-json="{{project.jsonize(id=1, subscribed=1)}}"
            data-url="project">
        <span class="false-div"><i class="fa fa-eye"></i> &nbsp;Watch</span>
        <span class="true-div"><i class="fa fa-eye-slash"></i> &nbsp;Unwatch</span>
      </a>
      <a class="btn btn-default"
        href="{{url_for('main.new_improvement',
              username=project.maintainer.username,
              purl_key=project.url_key) }}">
        Suggest an Improvement
      </a>
      <a class="btn btn-default" href="{{url_for('main.project_settings',
                                                 username=project.maintainer.username,
                                                 url_key=project.url_key)}}">
        <i class="fa fa-large fa-gear"></i>
        Project Settings
      </a>
    </div>
  </div>
</div>

<div class="row">
  <h3>Improvements</h3>
  <table class="table table-hover">
    <tbody>
      {% for imp in project.get_improvements(): %}
      <tr>
        <td class="fit-width">
          <a data-json="{{imp.jsonize(url_key=1, project=1, vote_status=1)}}"
            data-type="vote"
            class="btn btn-xs btn-info">
            <span class="false-div">Vote&nbsp; <i class="fa fa-plus"></i></span>
            <span class="true-div">Unvote&nbsp; <i class="fa fa-minus"></i></span>
          </a>
          &nbsp;&nbsp;
          <b>{{imp.votes}} vote{{imp.votes|plural}}</b>
        </td>
        <td><a href="{{imp.get_abs_url()}}">{{imp.brief}}</a></td>
      </tr>
      {% else %}
      <tr>
        <td colspan="2"><b>No improvements to view, you should suggest one!</b></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% if project.events %}
<div class="row">
  <h3>Events</h3>
  {% for event in project.events %}
    {% include event.template %}
  {% endfor %}
</div>
{% endif %}
{% endblock %}
